{# SPDX-License-Identifier: GPL-3.0-or-later
#
# Copyright (c) 2025 - present Incudo Labs Inc.
#
# This file is part of Orion's Belt Project (https://github.com/IncudoLABS/orions-belt).
#
# Published by the IncudoLABS.
# Original author: Marko Sarunac <128757181+SaruWiz@users.noreply.github.com>
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.
#
# Template ID: OB-005-T
# Used by: OB-005
#}
# This file is used to configure system-wide settings for user accounts
# and password policies. It is read by the login program, and by user
# management tools like useradd and usermod.
#
# For more information, see login.defs(5).

# Login Definitions Configuration
# Generated by Ansible Security Hardening Playbook

# Login definitions configuration template
# This template is used by OB-005 (password_policies.yml) #}

# Login Definitions Configuration
# Generated by Ansible Security Hardening Playbook

# Password aging controls
PASS_MAX_DAYS	{{ password_maxage }}
PASS_MIN_DAYS	{{ password_minage }}
PASS_WARN_AGE	{{ password_warnage }}

# User ID limits
UID_MIN			1000
UID_MAX			60000

# System user ID limits
SYS_UID_MIN		100
SYS_UID_MAX		999

# Group ID limits
GID_MIN			1000
GID_MAX			60000

# System group ID limits
SYS_GID_MIN		100
SYS_GID_MAX		999

# Default user settings
CREATE_HOME		yes
USERGROUPS_ENAB		yes

# Login settings
LOGIN_RETRIES		3
LOGIN_TIMEOUT		60
LOGIN_STRING		"Debian GNU/Linux"

# Console settings
CONSOLE			/etc/securetty
CONSOLE_GROUPS		floppy:audio:cdrom:dip:video:plugdev:scanner:bluetooth:netdev

# Default umask
UMASK			022

# Password encryption method
ENCRYPT_METHOD		SHA512

# User environment
ENV_PATH		/usr/local/bin:/usr/bin:/bin
ENV_ROOTPATH		/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# Mail settings
MAIL_DIR		/var/mail
MAIL_FILE		.mail

# Hush login
HUSHLOGIN_FILE		.hushlogin

# Last log
LASTLOG_ENAB		yes
FAILLOG_ENAB		yes

# Logging
LOG_OK_LOGINS		no
LOG_UNKFAIL_ENAB	no
LOGIN_STRING		"Debian GNU/Linux"

# Chfn settings
CHFN_AUTH		yes
CHFN_RESTRICT		rwh

# Chsh settings
CHSH_AUTH		yes

# Default user shell
DEFAULT_HOME		yes

# User deletion
USERDEL_CMD		/usr/sbin/userdel -r

# Password aging
PASS_CHANGE_TRIES	3
PASS_ALWAYS_WARN	yes
PASS_MIN_LEN		{{ password_minlen }} 