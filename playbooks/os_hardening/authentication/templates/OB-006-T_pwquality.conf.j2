{# SPDX-License-Identifier: GPL-3.0-or-later
#
# Copyright (c) 2023 - present Expiscor Group Inc.
#
# This file is part of Orion's Belt Project (https://github.com/IncudoLABS/orions-belt).
#
# Published by the IncudoLABS.
# Original author: Marko Sarunac <128757181+SaruWiz@users.noreply.github.com>
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.
#
# Template ID: OB-006-T
# Used by: OB-005, OB-006
#}
#
# This file is used to configure the password quality checking
# library, libpwquality. It is used by the pam_pwquality PAM
# library to check the quality of user passwords.
#
# Password Quality Configuration
# Generated by Ansible Security Hardening Playbook

# Password quality configuration template
# This template is used by OB-005 (password_policies.yml) #}

# Password length settings
minlen = {{ password_minlen }}

# Character class requirements
minclass = {{ password_minclass }}
ucredit = {{ password_ucredit }}
lcredit = {{ password_lcredit }}
dcredit = {{ password_dcredit }}
ocredit = {{ password_ocredit }}

# Complexity requirements
maxrepeat = {{ password_maxrepeat }}
maxsequence = {{ password_maxsequence }}
maxclassrepeat = {{ password_maxclassrepeat }}

# Dictionary and user checks (0=disabled, 1=enabled)
gecoscheck = {{ 1 if password_gecoscheck == "yes" else 0 }}
dictcheck = {{ 1 if password_dictcheck == "yes" else 0 }}
usercheck = {{ 1 if password_usercheck == "yes" else 0 }}

# Password difference requirements
difok = {{ password_difok }}

# Enforcing settings (0=disabled, 1=enabled)
enforcing = {{ 1 if password_enforcing == "yes" else 0 }}
retry = {{ password_retry }} 