{# SPDX-License-Identifier: GPL-3.0-or-later
#
# Copyright (c) 2025 - present Incudo Labs Inc.
#
# This file is part of Orion's Belt Project (https://github.com/IncudoLABS/orions-belt).
#
# Published by the IncudoLABS.
# Original author: Marko Sarunac <128757181+SaruWiz@users.noreply.github.com>
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.
#}
# Template ID: OB-002-T

# AIDE configuration file for Debian 12 Security Hardening
# Generated by Ansible Security Hardening Playbook

# Database location (using new database_in option)
database_in=file:{{ aide_database }}

# Database location after update
database_out=file:{{ aide_database }}.new

# Log level (reduced from info to warning to minimize noise)
log_level=warning

# Report level
report_url=file:{{ aide_log_dir }}/aide.report

# Exclude problematic directories that cause hangs and permission issues
!/proc/
!/sys/
!/dev/
!/tmp/
!/var/tmp/
!/run/
!/var/run/
!/var/cache/
!/var/lib/apt/
!/var/log/journal/
!/var/spool/
!/var/mail/
!/home/
!/root/
!/lost+found/
!/boot/efi/
!/etc/grub.d/
!/etc/ssl/private/
!/var/cache/apparmor/
!/var/cache/ldconfig/
!/var/cache/private/
!/var/lib/private/
!/var/log/private/
!/var/ossec/
!/var/spool/cron/crontabs/
!/var/spool/exim4/

# Monitor critical system directories
/etc/ R
/boot/ R
/usr/bin/ R
/usr/sbin/ R
/bin/ R
/sbin/ R
/lib/ R
/lib64/ R
/usr/lib/ R
/usr/lib64/ R

# Monitor configuration files
/etc/passwd$ R
/etc/group$ R
/etc/shadow$ R
/etc/gshadow$ R
/etc/sudoers$ R
/etc/ssh/sshd_config$ R
/etc/fstab$ R

# Monitor everything else (but exclude the problematic dirs above)
/ R 